#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Професійний переклад units_l_russian.yml на українську
З розширеним словником військової термінології
"""

import re

# Розширений російсько-український словник
TRANSLATION_DICT = {
    # Базові слова
    'всегда': 'завжди',
    'никогда': 'ніколи',
    'должно': 'має',
    'должен': 'повинен',
    'если': 'якщо',
    'когда': 'коли',
    'было': 'було',
    'были': 'були',
    'будет': 'буде',
    'может': 'може',
    'можно': 'можна',
    'нужно': 'потрібно',
    'надо': 'треба',
    'сейчас': 'зараз',
    'только': 'тільки',
    'очень': 'дуже',
    'много': 'багато',
    'мало': 'мало',
    'больше': 'більше',
    'меньше': 'менше',
    'лучше': 'краще',
    'хуже': 'гірше',
    'выше': 'вище',
    'ниже': 'нижче',
    'раньше': 'раніше',
    'позже': 'пізніше',

    # Військові терміни
    'полк': 'полк',
    'полка': 'полку',
    'полку': 'полку',
    'полком': 'полком',
    'полков': 'полків',
    'полках': 'полках',
    'Пехотный полк': 'Піхотний полк',
    'Кавалерийский полк': 'Кавалерійський полк',
    'Артиллерийский полк': 'Артилерійський полк',
    'Вспомогательный полк': 'Допоміжний полк',
    'Рыцарский полк': 'Лицарський полк',

    # Типи військ
    'пехота': 'піхота',
    'Пехота': 'Піхота',
    'кавалерия': 'кавалерія',
    'Кавалерия': 'Кавалерія',
    'артиллерия': 'артилерія',
    'Артиллерия': 'Артилерія',
    'ополчение': 'ополчення',
    'Ополчение': 'Ополчення',

    # Кораблі
    'корабль': 'корабель',
    'корабля': 'корабля',
    'кораблю': 'кораблю',
    'кораблем': 'кораблем',
    'корабле': 'кораблі',
    'кораблей': 'кораблів',
    'кораблях': 'кораблях',
    'Тяжёлый корабль': 'Важкий корабель',
    'Лёгкий корабль': 'Легкий корабель',
    'Транспортное судно': 'Транспортне судно',
    'Боевая галера': 'Бойова галера',
    'судно': 'судно',
    'суда': 'судна',

    # Епохи
    'эпохи': 'епохи',
    'эпоха': 'епоха',
    'эпохе': 'епосі',
    'Традиций': 'Традицій',
    'Возрождения': 'Відродження',
    'Открытий': 'Відкриттів',
    'Реформации': 'Реформації',
    'Абсолютизма': 'Абсолютизму',
    'Революций': 'Революцій',

    # Війна та битва
    'война': 'війна',
    'войны': 'війни',
    'войне': 'війні',
    'войну': 'війну',
    'войной': 'війною',
    'битва': 'битва',
    'битвы': 'битви',
    'битве': 'битві',
    'битву': 'битву',
    'битвой': 'битвою',
    'сражение': 'битва',
    'сражении': 'битві',
    'бой': 'бій',
    'боя': 'бою',
    'бою': 'бою',
    'боем': 'боєм',

    # Армія та флот
    'армия': 'армія',
    'армии': 'армії',
    'армию': 'армію',
    'армией': 'армією',
    'флот': 'флот',
    'флота': 'флоту',
    'флоту': 'флоту',
    'флотом': 'флотом',
    'флоте': 'флоті',
    'флотов': 'флотів',

    # Держава та країна
    'государство': 'держава',
    'государства': 'держави',
    'государству': 'державі',
    'держава': 'держава',
    'державе': 'державі',
    'державы': 'держави',
    'державу': 'державу',
    'державой': 'державою',

    # Люди та населення
    'население': 'населення',
    'народ': 'народ',
    'народа': 'народу',
    'солдат': 'солдат',
    'солдата': 'солдата',
    'солдаты': 'солдати',
    'солдатами': 'солдатами',
    'воин': 'воїн',
    'воина': 'воїна',
    'воины': 'воїни',
    'воинов': 'воїнів',
    'воинами': 'воїнами',
    'войска': 'війська',
    'войск': 'військ',
    'войсками': 'військами',
    'войсках': 'військах',

    # Правитель
    'правитель': 'правитель',
    'правителя': 'правителя',
    'правителю': 'правителю',
    'правителем': 'правителем',
    'король': 'король',
    'королю': 'королю',
    'короля': 'короля',
    'королём': 'королем',
    'император': 'імператор',
    'императора': 'імператора',

    # Адміністрація
    'полководец': 'полководець',
    'полководца': 'полководця',
    'командир': 'командир',
    'командира': 'командира',
    'командиром': 'командиром',
    'генерал': 'генерал',
    'генерала': 'генерала',
    'адмирал': 'адмірал',
    'адмирала': 'адмірала',

    # Прикметники
    'королевский': 'королівський',
    'Королевский': 'Королівський',
    'королевская': 'королівська',
    'Королевская': 'Королівська',
    'королевское': 'королівське',
    'Королевское': 'Королівське',
    'королевские': 'королівські',
    'Королевские': 'Королівські',

    # Дієслова
    'используется': 'використовується',
    'используются': 'використовуються',
    'обладает': 'має',
    'обсуждается': 'обговорюється',
    'является': 'є',
    'находится': 'знаходиться',
    'находятся': 'знаходяться',
    'принадлежит': 'належить',
    'говорит': 'говорить',
    'открывает': 'відкриває',
    'требуется': 'потрібно',
    'составляет': 'становить',
    'заседает': 'засідає',
    'выполняется': 'виконується',
    'присутствие': 'присутність',
    'служит': 'служить',
    'служат': 'служать',
    'командует': 'командує',
    'назначить': 'призначити',
    'участвует': 'бере участь',
    'представляет': 'являє',
    'представляют': 'являють',
    'позволяет': 'дозволяє',
    'позволяют': 'дозволяють',
    'состоит': 'складається',
    'составляют': 'становлять',
    'вооружён': 'озброєний',
    'вооружена': 'озброєна',
    'вооружены': 'озброєні',

    # Іменники
    'культура': 'культура',
    'культуры': 'культури',
    'религия': 'релігія',
    'религии': 'релігії',
    'торговля': 'торгівля',
    'династия': 'династія',
    'династии': 'династії',
    'столица': 'столиця',
    'столицы': 'столиці',
    'столице': 'столиці',
    'район': 'район',
    'районе': 'районі',
    'районах': 'районах',
    'районов': 'районів',
    'здание': 'будівля',
    'закон': 'закон',
    'законов': 'законів',
    'политика': 'політика',
    'союз': 'союз',
    'враг': 'ворог',
    'врага': 'ворога',
    'враги': 'вороги',
    'врагов': 'ворогів',
    'врагам': 'ворогам',
    'противник': 'противник',
    'противника': 'противника',
    'сосед': 'сусід',
    'соседа': 'сусіда',
    'владелец': 'власник',
    'владельца': 'власника',
    'парламент': 'парламент',
    'собрание': 'збори',
    'совет': 'рада',
    'совета': 'ради',
    'советом': 'радою',
    'действие': 'дія',
    'действия': 'дії',
    'способность': 'здатність',
    'улучшение': 'поліпшення',
    'исследование': 'дослідження',
    'очередь': 'черга',
    'дорога': 'дорога',
    'привилегия': 'привілей',
    'время': 'час',

    # Прийменники та сполучники
    'из': 'з',
    'от': 'від',
    'до': 'до',
    'для': 'для',
    'при': 'при',
    'над': 'над',
    'под': 'під',
    'перед': 'перед',
    'после': 'після',
    'через': 'через',
    'между': 'між',
    'среди': 'серед',
    'вокруг': 'навколо',
    'около': 'біля',
    'возле': 'біля',
    'внутри': 'всередині',
    'снаружи': 'зовні',
    'вверх': 'вгору',
    'вниз': 'вниз',
    'вперед': 'вперед',
    'назад': 'назад',

    # Числівники та порядкові
    'первый': 'перший',
    'первая': 'перша',
    'первое': 'перше',
    'первые': 'перші',
    'второй': 'другий',
    'вторая': 'друга',
    'третий': 'третій',
    'третья': 'третя',

    # Військова термінологія
    'лучник': 'лучник',
    'лучники': 'лучники',
    'лучников': 'лучників',
    'копейщик': 'списник',
    'копейщики': 'списники',
    'копейщиков': 'списників',
    'всадник': 'вершник',
    'всадники': 'вершники',
    'всадников': 'вершників',
    'наёмник': 'найманець',
    'наёмники': 'найманці',
    'наёмников': 'найманців',
    'гвардия': 'гвардія',
    'гвардии': 'гвардії',
    'рыцарь': 'лицар',
    'рыцаря': 'лицаря',
    'рыцари': 'лицарі',
    'рыцарей': 'лицарів',
    'мушкетёр': 'мушкетер',
    'мушкетёры': 'мушкетери',
    'мушкетёров': 'мушкетерів',
    'стрелок': 'стрілець',
    'стрелки': 'стрільці',
    'стрелков': 'стрільців',
    'доспех': 'обладунок',
    'доспехи': 'обладунки',
    'доспехах': 'обладунках',
    'оружие': 'зброя',
    'оружия': 'зброї',
    'оружием': 'зброєю',
    'меч': 'меч',
    'меча': 'меча',
    'мечами': 'мечами',
    'копьё': 'спис',
    'копья': 'списа',
    'копьями': 'списами',
    'лук': 'лук',
    'луки': 'луки',
    'луков': 'луків',
    'арбалет': 'арбалет',
    'арбалеты': 'арбалети',
    'арбалетов': 'арбалетів',
    'пушка': 'гармата',
    'пушки': 'гармати',
    'пушек': 'гармат',
    'пушками': 'гарматами',
    'пистолет': 'пістолет',
    'пистолеты': 'пістолети',
    'пистолетов': 'пістолетів',
    'ружьё': 'рушниця',
    'ружья': 'рушниці',
    'ружей': 'рушниць',
    'мушкет': 'мушкет',
    'мушкета': 'мушкета',
    'мушкеты': 'мушкети',
    'мушкетов': 'мушкетів',

    # Морська термінологія
    'галера': 'галера',
    'галеры': 'галери',
    'галер': 'галер',
    'фрегат': 'фрегат',
    'фрегата': 'фрегата',
    'фрегаты': 'фрегати',
    'фрегатов': 'фрегатів',
    'каракка': 'каракка',
    'каравелла': 'каравела',
    'галеон': 'галеон',
    'галеона': 'галеона',
    'галеоны': 'галеони',
    'галеонов': 'галеонів',
    'мачта': 'щогла',
    'мачты': 'щогли',
    'парус': 'вітрило',
    'паруса': 'вітрила',
    'парусов': 'вітрил',
    'весло': 'весло',
    'вёсла': 'весла',
    'вёсел': 'весел',
    'гребец': 'веслар',
    'гребцы': 'веслярі',
    'гребцов': 'веслярів',
    'порт': 'порт',
    'порта': 'порту',
    'порту': 'порту',
    'портом': 'портом',
    'море': 'море',
    'моря': 'моря',
    'морю': 'морю',
    'морем': 'морем',
    'океан': 'океан',
    'океана': 'океану',
    'флотилия': 'флотилія',

    # Описові слова
    'большой': 'великий',
    'большая': 'велика',
    'большое': 'велике',
    'большие': 'великі',
    'малый': 'малий',
    'малая': 'мала',
    'малое': 'мале',
    'малые': 'малі',
    'новый': 'новий',
    'новая': 'нова',
    'новое': 'нове',
    'новые': 'нові',
    'старый': 'старий',
    'старая': 'стара',
    'старое': 'старе',
    'старые': 'старі',
    'тяжёлый': 'важкий',
    'тяжёлая': 'важка',
    'тяжёлое': 'важке',
    'тяжёлые': 'важкі',
    'лёгкий': 'легкий',
    'лёгкая': 'легка',
    'лёгкое': 'легке',
    'лёгкие': 'легкі',
    'сильный': 'сильний',
    'сильная': 'сильна',
    'слабый': 'слабкий',
    'слабая': 'слабка',
    'быстрый': 'швидкий',
    'быстрая': 'швидка',
    'медленный': 'повільний',
    'медленная': 'повільна',
    'основной': 'основний',
    'основная': 'основна',
    'основное': 'основне',
    'основные': 'основні',
    'главный': 'головний',
    'главная': 'головна',
    'главное': 'головне',
    'главные': 'головні',
    'элитный': 'елітний',
    'элитная': 'елітна',
    'элитные': 'елітні',

    # Інше
    'ближайший': 'найближчий',
    'ближайшие': 'найближчі',
    'следующий': 'наступний',
    'следующая': 'наступна',
    'следующие': 'наступні',
    'можем': 'можемо',
    'может': 'може',
    'нет': 'немає',
    'есть': 'є',
    'нельзя': 'не можна',
    'можно': 'можна',
    'необходимо': 'необхідно',
    'количество': 'кількість',
    'максимум': 'максимум',
    'минимум': 'мінімум',
    'общий': 'загальний',
    'общая': 'загальна',
    'общее': 'загальне',
    'общие': 'загальні',
    'текущий': 'поточний',
    'текущая': 'поточна',
    'текущее': 'поточне',
    'улучшить': 'поліпшити',
    'улучшен': 'поліпшений',
    'улучшена': 'поліпшена',
    'улучшено': 'поліпшено',
    'улучшены': 'поліпшені',
}

def translate_text(text):
    """Перекласти текст, зберігаючи технічні елементи"""
    if not text or text.strip().startswith('#'):
        return text

    # Зберігаємо технічні елементи
    placeholders = {}
    counter = 0

    # Зберігаємо всі технічні конструкції
    patterns = [
        (r'\[Concept\([^]]+\)\|e\]', 'CONCEPT'),
        (r'\[.*?\]', 'BRACKET'),
        (r'\$[A-Z_]+\$', 'VAR'),
        (r'\$[A-Z_]+\|[^$]+\$', 'VARFORMAT'),
        (r'#[A-Z_]+!', 'TAG'),
        (r'#TOOLTIP:[^#]+#', 'TOOLTIP'),
        (r'#ONCLICK:[^#]+#', 'ONCLICK'),
        (r'#italic [^#]+#!', 'ITALIC'),
        (r'@[a-z_]+!', 'ICON'),
        (r'"[^"]*"', 'QUOTE'),
    ]

    for pattern, prefix in patterns:
        for match in re.finditer(pattern, text):
            placeholder = f'__{prefix}{counter}__'
            placeholders[placeholder] = match.group(0)
            text = text.replace(match.group(0), placeholder, 1)
            counter += 1

    # Перекладаємо текст
    for ru, ua in TRANSLATION_DICT.items():
        # Ціле слово
        text = re.sub(r'\b' + re.escape(ru) + r'\b', ua, text)

    # Відновлюємо технічні елементи
    for placeholder, original in placeholders.items():
        text = text.replace(placeholder, original)

    return text

def translate_file():
    """Перекласти файл"""
    input_file = "/Users/furmonenko/Desktop/eu5-ukrainian-localization/reference/russian/units_l_russian.yml"
    output_file = "/Users/furmonenko/Desktop/eu5-ukrainian-localization/main_menu/localization/english/units_l_english.yml"

    print("Початок перекладу units_l_russian.yml...")
    print("=" * 80)

    with open(input_file, 'r', encoding='utf-8-sig') as f:
        lines = f.readlines()

    translated_lines = []
    translated_count = 0

    for i, line in enumerate(lines, 1):
        # Перший рядок - заголовок
        if i == 1:
            translated_lines.append('l_english:\n')
            continue

        # Коментарі та порожні рядки
        if line.strip().startswith('#') or not line.strip():
            translated_lines.append(line)
            continue

        # Рядки з перекладом
        match = re.match(r'^(\s*)([^:]+):\s*"(.+)"(.*)$', line.rstrip())
        if match:
            indent, key, text, suffix = match.groups()
            translated_text = translate_text(text)
            translated_lines.append(f'{indent}{key}: "{translated_text}"{suffix}\n')
            if text != translated_text:
                translated_count += 1
        else:
            # Рядки без лапок
            match2 = re.match(r'^(\s*)([^:]+):(.*)$', line.rstrip())
            if match2:
                indent, key, value = match2.groups()
                translated_value = translate_text(value.strip())
                if value.strip():
                    translated_lines.append(f'{indent}{key}: {translated_value}\n')
                else:
                    translated_lines.append(f'{indent}{key}:{value}\n')
            else:
                translated_lines.append(line)

        # Прогрес
        if i % 200 == 0:
            print(f"  Оброблено {i}/{len(lines)} рядків...")

    # Зберігаємо
    with open(output_file, 'w', encoding='utf-8-sig') as f:
        f.writelines(translated_lines)

    print("=" * 80)
    print(f"✓ Переклад завершено!")
    print(f"  Всього рядків: {len(lines)}")
    print(f"  Перекладено: {translated_count}")
    print(f"  Збережено: {output_file}")

if __name__ == "__main__":
    translate_file()
