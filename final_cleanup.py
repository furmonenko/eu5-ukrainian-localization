#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Фінальне очищення файлу від російських слів
"""

import re

def final_cleanup(file_path):
    """Фінальне очищення від російських слів"""

    with open(file_path, 'r', encoding='utf-8-sig') as f:
        content = f.read()

    # Додаткові заміни для залишкових російських слів
    additional_replacements = [
        # В назвах (NAME)
        ("Торговая эффективность", "Торгова ефективність"),
        ("Доходы от торговли", "Доходи від торговлі"),
        ("Размер армії", "Розмір армії"),
        ("Размер флоту", "Розмір флоту"),
        ("Боевой дух", "Бойовий дух"),
        ("Максимальная усталость", "Максимальна втома"),
        ("Дальность постачання", "Дальність постачання"),
        ("Содержание армії", "Утримання армії"),
        ("Содержание флоту", "Утримання флоту"),
        ("Содержание наёмников", "Утримання найманців"),
        ("Затраты на", "Витрати на"),
        ("Потери бойового духу", "Втрати бойового духу"),
        ("Зниження бойового духу", "Зниження бойового духу"),
        ("Помощь в", "Допомога в"),
        ("Время в пути", "Час у дорозі"),
        ("Восстановление бойового духу", "Відновлення бойового духу"),

        # В описах (DESC) - російські залишки
        (" може влиять", " може впливати"),
        ("vlияет", "впливає"),
        (" его ", " його "),
        (" за месяц", " за місяць"),
        ("котором", "якому"),
        ("которому", "якому"),
        ("котором", "якому"),
        (" может ", " може "),
        (" могут ", " можуть "),
        (" будет ", " буде "),
        (" будут ", " будуть "),
        (" на то,", " на те,"),
        ("необходимо", "необхідно"),
        (" количество", " кількість"),
        ("влияет на", "впливає на"),
        ("определяет", "визначає"),
        (" ли ", " чи "),
        ("перемещаться", "переміщуватися"),
        ("отряд", "підрозділ"),
        ("армия", "армія"),
        (" для ", " для "),
        (" при ", " при "),
        (" к ", " до "),
        (" на ", " на "),
        (" от ", " від "),

        # Концепти всередині Concept()
        ("'размер'", "'розмір'"),
        ("'опыта'", "'досвіду'"),
        ("'боевой дух'", "'бойовий дух'"),
        ("'бойового духа'", "'бойового духу'"),
        ("'усталости от війни'", "'втоми від війни'"),
        ("'армия'", "'армія'"),
        ("'источник їжі'", "'джерело їжі'"),
        ("'отряда'", "'підрозділу'"),
        ("'отряд'", "'підрозділ'"),

        # Додаткові слова
        ("Торговая", "Торгова"),
        ("Доходы", "Доходи"),
        ("Приріст", "Приріст"),
        ("Спад", "Спад"),
    ]

    for ru, uk in additional_replacements:
        content = content.replace(ru, uk)

    # Записуємо результат
    with open(file_path, 'w', encoding='utf-8-sig') as f:
        f.write(content)

    print(f"Фінальне очищення завершено!")

    # Перевіряємо що залишилося
    russian_patterns = [
        r'\bможет\b', r'\bможно\b', r'\bнужно\b', r'\bдолжен\b', r'\bбудет\b', r'\bбудут\b',
        r'\bвлияет\b', r'\bопределяет\b', r'\bнеобходимо\b', r'\bколичество\b',
        r'\bкоторый\b', r'\bкоторая\b', r'\bкоторые\b', r'\bкоторую\b',
    ]

    found = {}
    for pattern in russian_patterns:
        matches = re.findall(pattern, content, re.IGNORECASE)
        if matches:
            found[pattern] = len(matches)

    if found:
        print("\nЗалишилися російські слова:")
        for pattern, count in sorted(found.items(), key=lambda x: x[1], reverse=True):
            print(f"  {pattern}: {count}")
    else:
        print("\nВідмінно! Основні російські слова видалено.")

if __name__ == "__main__":
    file_path = "/Users/furmonenko/Desktop/eu5-ukrainian-localization/main_menu/localization/english/modifier_types_l_english.yml"
    final_cleanup(file_path)
